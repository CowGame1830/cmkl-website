{
    "sourceFile": "src/pages/OptimizerAgent.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1764425596111,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1764425596111,
            "name": "Commit-0",
            "content": "import React, { useState, useEffect } from 'react';\r\nimport { zones, recentActions, notifications } from '../data/mockData';\r\nimport type { Zone } from '../data/types';\r\nimport { \r\n  Users, \r\n  Activity, \r\n  AlertTriangle,\r\n  CheckCircle,\r\n  Bell,\r\n  RefreshCw,\r\n  BarChart3\r\n} from 'lucide-react';\r\nimport './OptimizerAgent.css';\r\n\r\nconst OptimizerAgent: React.FC = () => {\r\n  const [selectedDepartment, setSelectedDepartment] = useState<string>('all');\r\n  const [timeFilter, setTimeFilter] = useState<string>('24h');\r\n  const [autoRefresh, setAutoRefresh] = useState(true);\r\n  const [lastUpdated, setLastUpdated] = useState(new Date());\r\n\r\n  const departments = ['all', ...Array.from(new Set(zones.map(zone => zone.department)))];\r\n\r\n  const filteredZones = selectedDepartment === 'all' \r\n    ? zones \r\n    : zones.filter(zone => zone.department === selectedDepartment);\r\n\r\n  const filteredActions = recentActions.filter(action => {\r\n    const actionTime = new Date(action.timestamp);\r\n    const hoursAgo = timeFilter === '1h' ? 1 : timeFilter === '24h' ? 24 : 168; // 168 = 7 days\r\n    const cutoffTime = new Date(Date.now() - hoursAgo * 60 * 60 * 1000);\r\n    \r\n    return actionTime >= cutoffTime;\r\n  });\r\n\r\n  const getZoneUtilization = (zone: Zone) => {\r\n    return Math.round((zone.currentPersonnel / zone.maxCapacity) * 100);\r\n  };\r\n\r\n  const getEfficiencyScore = (zone: Zone) => {\r\n    const utilization = getZoneUtilization(zone);\r\n    if (utilization <= 80) return 'High';\r\n    if (utilization <= 95) return 'Medium';\r\n    return 'Low';\r\n  };\r\n\r\n  const getEfficiencyColor = (score: string) => {\r\n    switch (score) {\r\n      case 'High': return 'text-green-600 bg-green-100';\r\n      case 'Medium': return 'text-yellow-600 bg-yellow-100';\r\n      case 'Low': return 'text-red-600 bg-red-100';\r\n      default: return 'text-gray-600 bg-gray-100';\r\n    }\r\n  };\r\n\r\n  const getDepartmentSummary = () => {\r\n    const summary: Record<string, { total: number; capacity: number; zones: number }> = {};\r\n    \r\n    filteredZones.forEach(zone => {\r\n      if (!summary[zone.department]) {\r\n        summary[zone.department] = { total: 0, capacity: 0, zones: 0 };\r\n      }\r\n      summary[zone.department].total += zone.currentPersonnel;\r\n      summary[zone.department].capacity += zone.maxCapacity;\r\n      summary[zone.department].zones += 1;\r\n    });\r\n\r\n    return summary;\r\n  };\r\n\r\n  const getActionsByType = () => {\r\n    const actionCounts = filteredActions.reduce((acc, action) => {\r\n      acc[action.type] = (acc[action.type] || 0) + 1;\r\n      return acc;\r\n    }, {} as Record<string, number>);\r\n\r\n    return actionCounts;\r\n  };\r\n\r\n  const getRecentAlerts = () => {\r\n    return notifications.filter(notif => \r\n      (notif.type === 'warning' || notif.type === 'error') && !notif.read\r\n    );\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (autoRefresh) {\r\n      const interval = setInterval(() => {\r\n        setLastUpdated(new Date());\r\n      }, 30000); // Update every 30 seconds\r\n\r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [autoRefresh]);\r\n\r\n  const handleRefresh = () => {\r\n    setLastUpdated(new Date());\r\n  };\r\n\r\n  const formatTime = (date: Date) => {\r\n    return date.toLocaleTimeString('th-TH', { \r\n      hour: '2-digit', \r\n      minute: '2-digit',\r\n      second: '2-digit'\r\n    });\r\n  };\r\n\r\n  const departmentSummary = getDepartmentSummary();\r\n  const actionsByType = getActionsByType();\r\n  const recentAlerts = getRecentAlerts();\r\n\r\n  return (\r\n    <div className=\"optimizer-container\">\r\n      <div className=\"optimizer-header\">\r\n        <h1>Optimizer Agent</h1>\r\n        <p>Real-time personnel optimization and zone management</p>\r\n        \r\n        <div className=\"header-controls\">\r\n          <div className=\"filter-controls\">\r\n            <div className=\"filter-group\">\r\n              <label>Department:</label>\r\n              <select \r\n                value={selectedDepartment} \r\n                onChange={(e) => setSelectedDepartment(e.target.value)}\r\n              >\r\n                {departments.map(dept => (\r\n                  <option key={dept} value={dept}>\r\n                    {dept === 'all' ? 'All Departments' : dept}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n            \r\n            <div className=\"filter-group\">\r\n              <label>Time Range:</label>\r\n              <select \r\n                value={timeFilter} \r\n                onChange={(e) => setTimeFilter(e.target.value)}\r\n              >\r\n                <option value=\"1h\">Last Hour</option>\r\n                <option value=\"24h\">Last 24 Hours</option>\r\n                <option value=\"7d\">Last 7 Days</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"refresh-controls\">\r\n            <label className=\"auto-refresh\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={autoRefresh}\r\n                onChange={(e) => setAutoRefresh(e.target.checked)}\r\n              />\r\n              Auto-refresh\r\n            </label>\r\n            <button onClick={handleRefresh} className=\"refresh-btn\">\r\n              <RefreshCw className=\"w-4 h-4\" />\r\n            </button>\r\n            <span className=\"last-updated\">\r\n              Last updated: {formatTime(lastUpdated)}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"optimizer-grid\">\r\n        {/* Department Summary */}\r\n        <div className=\"optimizer-section department-summary\">\r\n          <h2>\r\n            <BarChart3 className=\"w-5 h-5\" />\r\n            Department Summary\r\n          </h2>\r\n          <div className=\"department-cards\">\r\n            {Object.entries(departmentSummary).map(([dept, stats]) => (\r\n              <div key={dept} className=\"department-card\">\r\n                <h3>{dept}</h3>\r\n                <div className=\"department-stats\">\r\n                  <div className=\"stat\">\r\n                    <span className=\"stat-label\">Personnel:</span>\r\n                    <span className=\"stat-value\">{stats.total}/{stats.capacity}</span>\r\n                  </div>\r\n                  <div className=\"stat\">\r\n                    <span className=\"stat-label\">Zones:</span>\r\n                    <span className=\"stat-value\">{stats.zones}</span>\r\n                  </div>\r\n                  <div className=\"stat\">\r\n                    <span className=\"stat-label\">Utilization:</span>\r\n                    <span className=\"stat-value\">\r\n                      {Math.round((stats.total / stats.capacity) * 100)}%\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n                <div className=\"utilization-bar\">\r\n                  <div \r\n                    className=\"utilization-fill\" \r\n                    style={{ \r\n                      width: `${Math.min((stats.total / stats.capacity) * 100, 100)}%`,\r\n                      backgroundColor: (stats.total / stats.capacity) > 0.9 ? '#ef4444' : \r\n                                     (stats.total / stats.capacity) > 0.8 ? '#f59e0b' : '#10b981'\r\n                    }}\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Zone Details */}\r\n        <div className=\"optimizer-section zone-details\">\r\n          <h2>\r\n            <Users className=\"w-5 h-5\" />\r\n            Zone Details\r\n          </h2>\r\n          <div className=\"zone-table\">\r\n            <div className=\"table-header\">\r\n              <div>Zone</div>\r\n              <div>Personnel</div>\r\n              <div>Utilization</div>\r\n              <div>Efficiency</div>\r\n              <div>Status</div>\r\n            </div>\r\n            {filteredZones.map((zone) => (\r\n              <div key={zone.id} className=\"table-row\">\r\n                <div className=\"zone-info\">\r\n                  <div className=\"zone-name\">{zone.name}</div>\r\n                  <div className=\"zone-dept\">{zone.department}</div>\r\n                </div>\r\n                <div className=\"personnel-count\">\r\n                  {zone.currentPersonnel}/{zone.maxCapacity}\r\n                </div>\r\n                <div className=\"utilization-cell\">\r\n                  <span>{getZoneUtilization(zone)}%</span>\r\n                  <div className=\"mini-bar\">\r\n                    <div \r\n                      className=\"mini-fill\" \r\n                      style={{ \r\n                        width: `${getZoneUtilization(zone)}%`,\r\n                        backgroundColor: getZoneUtilization(zone) > 90 ? '#ef4444' : \r\n                                       getZoneUtilization(zone) > 80 ? '#f59e0b' : '#10b981'\r\n                      }}\r\n                    ></div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"efficiency-cell\">\r\n                  <span className={`efficiency-badge ${getEfficiencyColor(getEfficiencyScore(zone))}`}>\r\n                    {getEfficiencyScore(zone)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"status-cell\">\r\n                  <span className={`status-badge ${zone.status === 'normal' ? 'status-normal' : \r\n                                                  zone.status === 'warning' ? 'status-warning' : 'status-critical'}`}>\r\n                    {zone.status}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Action Analytics */}\r\n        <div className=\"optimizer-section action-analytics\">\r\n          <h2>\r\n            <Activity className=\"w-5 h-5\" />\r\n            Action Analytics ({timeFilter})\r\n          </h2>\r\n          <div className=\"action-stats\">\r\n            {Object.entries(actionsByType).map(([type, count]) => (\r\n              <div key={type} className=\"action-stat\">\r\n                <div className=\"action-type\">{type.replace('_', ' ')}</div>\r\n                <div className=\"action-count\">{count}</div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n          \r\n          <div className=\"recent-actions\">\r\n            <h3>Recent Actions</h3>\r\n            {filteredActions.slice(0, 8).map((action) => (\r\n              <div key={action.id} className=\"action-item\">\r\n                <div className=\"action-time\">\r\n                  {new Date(action.timestamp).toLocaleTimeString('th-TH', { \r\n                    hour: '2-digit', \r\n                    minute: '2-digit' \r\n                  })}\r\n                </div>\r\n                <div className=\"action-details\">\r\n                  <div className=\"action-person\">{action.personName}</div>\r\n                  <div className=\"action-description\">{action.description}</div>\r\n                </div>\r\n                <div className={`action-type-badge ${action.type}`}>\r\n                  {action.type}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Active Alerts */}\r\n        <div className=\"optimizer-section alerts-panel\">\r\n          <h2>\r\n            <AlertTriangle className=\"w-5 h-5\" />\r\n            Active Alerts\r\n          </h2>\r\n          {recentAlerts.length > 0 ? (\r\n            <div className=\"alerts-list\">\r\n              {recentAlerts.map((alert) => (\r\n                <div key={alert.id} className={`alert-item alert-${alert.type}`}>\r\n                  <div className=\"alert-icon\">\r\n                    {alert.type === 'warning' ? \r\n                      <AlertTriangle className=\"w-4 h-4\" /> : \r\n                      <Bell className=\"w-4 h-4\" />\r\n                    }\r\n                  </div>\r\n                  <div className=\"alert-content\">\r\n                    <div className=\"alert-title\">{alert.title}</div>\r\n                    <div className=\"alert-message\">{alert.message}</div>\r\n                    <div className=\"alert-time\">\r\n                      {new Date(alert.timestamp).toLocaleTimeString('th-TH')}\r\n                    </div>\r\n                  </div>\r\n                  <div className={`alert-priority priority-${alert.priority}`}>\r\n                    {alert.priority}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"no-alerts\">\r\n              <CheckCircle className=\"w-8 h-8 text-green-500\" />\r\n              <p>No active alerts</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OptimizerAgent;"
        }
    ]
}