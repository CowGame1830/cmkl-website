{
    "sourceFile": "src/components/NotificationDropdown.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1764426743258,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1764426743258,
            "name": "Commit-0",
            "content": "import React, { useState, useRef, useEffect } from 'react';\r\nimport { Bell, X, Check, AlertTriangle, Info, CheckCircle } from 'lucide-react';\r\nimport { useNotifications } from '../context/NotificationContext';\r\nimport type { Notification } from '../data/types';\r\n\r\nconst NotificationDropdown: React.FC = () => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const { notifications, unreadCount, markAsRead, markAllAsRead } = useNotifications();\r\n  const dropdownRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  const getNotificationIcon = (type: Notification['type']) => {\r\n    switch (type) {\r\n      case 'error':\r\n        return <AlertTriangle className=\"w-4 h-4 text-red-500\" />;\r\n      case 'warning':\r\n        return <AlertTriangle className=\"w-4 h-4 text-yellow-500\" />;\r\n      case 'info':\r\n        return <Info className=\"w-4 h-4 text-blue-500\" />;\r\n      case 'success':\r\n        return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\r\n      default:\r\n        return <Info className=\"w-4 h-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const formatTimeAgo = (timestamp: string) => {\r\n    const now = new Date();\r\n    const notifTime = new Date(timestamp);\r\n    const diffInMinutes = Math.floor((now.getTime() - notifTime.getTime()) / (1000 * 60));\r\n    \r\n    if (diffInMinutes < 1) return 'Just now';\r\n    if (diffInMinutes < 60) return `${diffInMinutes}m ago`;\r\n    \r\n    const diffInHours = Math.floor(diffInMinutes / 60);\r\n    if (diffInHours < 24) return `${diffInHours}h ago`;\r\n    \r\n    const diffInDays = Math.floor(diffInHours / 24);\r\n    return `${diffInDays}d ago`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative\" ref={dropdownRef}>\r\n      <button\r\n        onClick={() => setIsOpen(!isOpen)}\r\n        className=\"relative p-2 rounded-lg text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-colors duration-200 group\"\r\n        title=\"Notifications\"\r\n      >\r\n        <Bell className=\"w-5 h-5\" />\r\n        {unreadCount > 0 && (\r\n          <span className=\"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center\">\r\n            {unreadCount > 99 ? '99+' : unreadCount}\r\n          </span>\r\n        )}\r\n      </button>\r\n\r\n      {isOpen && (\r\n        <div className=\"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-lg border border-gray-200 z-50\">\r\n          <div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900\">Notifications</h3>\r\n            <div className=\"flex items-center gap-2\">\r\n              {unreadCount > 0 && (\r\n                <button\r\n                  onClick={markAllAsRead}\r\n                  className=\"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1\"\r\n                >\r\n                  <Check className=\"w-3 h-3\" />\r\n                  Mark all read\r\n                </button>\r\n              )}\r\n              <button\r\n                onClick={() => setIsOpen(false)}\r\n                className=\"text-gray-400 hover:text-gray-600\"\r\n              >\r\n                <X className=\"w-4 h-4\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"max-h-96 overflow-y-auto\">\r\n            {notifications.length === 0 ? (\r\n              <div className=\"p-8 text-center text-gray-500\">\r\n                <Bell className=\"w-8 h-8 mx-auto mb-2 text-gray-300\" />\r\n                <p>No notifications yet</p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"divide-y divide-gray-100\">\r\n                {notifications.slice(0, 10).map((notification) => (\r\n                  <div\r\n                    key={notification.id}\r\n                    className={`p-4 hover:bg-gray-50 cursor-pointer transition-colors ${\r\n                      !notification.read ? 'bg-blue-50 border-l-4 border-l-blue-500' : ''\r\n                    }`}\r\n                    onClick={() => {\r\n                      if (!notification.read) {\r\n                        markAsRead(notification.id);\r\n                      }\r\n                    }}\r\n                  >\r\n                    <div className=\"flex items-start gap-3\">\r\n                      <div className=\"flex-shrink-0 mt-1\">\r\n                        {getNotificationIcon(notification.type)}\r\n                      </div>\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <div className=\"flex items-start justify-between\">\r\n                          <h4 className={`text-sm font-medium ${\r\n                            !notification.read ? 'text-gray-900' : 'text-gray-700'\r\n                          }`}>\r\n                            {notification.title}\r\n                          </h4>\r\n                          <span className=\"ml-2 text-xs text-gray-500 flex-shrink-0\">\r\n                            {formatTimeAgo(notification.timestamp)}\r\n                          </span>\r\n                        </div>\r\n                        <p className={`mt-1 text-sm ${\r\n                          !notification.read ? 'text-gray-700' : 'text-gray-500'\r\n                        }`}>\r\n                          {notification.message}\r\n                        </p>\r\n                        {notification.priority && notification.priority !== 'low' && (\r\n                          <span className={`inline-block mt-2 px-2 py-1 text-xs rounded-full ${\r\n                            notification.priority === 'high'\r\n                              ? 'bg-red-100 text-red-800'\r\n                              : 'bg-yellow-100 text-yellow-800'\r\n                          }`}>\r\n                            {notification.priority} priority\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                      {!notification.read && (\r\n                        <div className=\"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2\"></div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {notifications.length > 10 && (\r\n            <div className=\"p-3 border-t border-gray-200 text-center\">\r\n              <button className=\"text-sm text-blue-600 hover:text-blue-800\">\r\n                View all notifications\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationDropdown;"
        }
    ]
}